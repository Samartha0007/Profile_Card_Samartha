<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile Card Service</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/11.4.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/11.4.0/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/11.4.0/firebase-storage.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Poppins', sans-serif; }
        body { background: #f4f8f2; display: flex; align-items: center; justify-content: center; flex-direction: column; height: 100vh; padding: 20px; }
        .profile-card { width: 340px; background: white; border-radius: 20px; text-align: center; box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15); position: relative; overflow: hidden; transition: transform 0.4s ease-in-out, box-shadow 0.4s ease-in-out; }
        .profile-card:hover { transform: translateY(-10px); box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2); }
        .top-section { background: linear-gradient(135deg, #D84A65, #C13584); height: 140px; border-bottom-left-radius: 50px; border-bottom-right-radius: 50px; position: relative; }
        .profile-image { width: 100px; height: 100px; border-radius: 50%; border: 5px solid white; position: absolute; top: 70px; left: 50%; transform: translateX(-50%); transition: transform 0.3s ease-in-out; }
        .profile-details { padding: 60px 20px 20px; }
        .profile-name { font-size: 18px; font-weight: 600; color: #333; }
        .profile-bio { font-size: 14px; color: #777; margin-top: 5px; }
        .social-icons { margin-top: 15px; display: flex; justify-content: center; gap: 15px; }
        .social-icons a { font-size: 18px; color: #444; transition: transform 0.3s ease-in-out, color 0.3s ease-in-out; }
        .social-icons a:hover { color: #D84A65; transform: scale(1.2); }
        @media (max-width: 400px) { .profile-card { width: 90%; } }
    </style>
</head>
<body>

    <h2>Create Profile</h2>
    <input type="text" id="name" placeholder="Name" required><br>
    <textarea id="bio" placeholder="Short Bio" required></textarea><br>
    <input type="url" id="instagram" placeholder="Instagram URL"><br>
    <input type="url" id="twitter" placeholder="Twitter URL"><br>
    <input type="file" id="imageUpload" accept="image/*"><br>
    <button onclick="createProfile()">Create Profile</button>

    <h2>Profile</h2>
    <div id="profileContainer"></div>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBb3x_zD9JaFwL9PhmngCNZlS2fOh6MBa4",
            authDomain: "newai-52371.firebaseapp.com",
            projectId: "newai-52371",
            storageBucket: "newai-52371.appspot.com",
            messagingSenderId: "480586908639",
            appId: "1:480586908639:web:f4645a852c4df724c6fa6a"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // Cloudinary Upload Config
        const CLOUDINARY_URL = "https://api.cloudinary.com/v1_1/dw1qrki2c/upload";
        const UPLOAD_PRESET = "profile_uploads";

        async function createProfile() {
            const name = document.getElementById("name").value;
            const bio = document.getElementById("bio").value;
            const instagram = document.getElementById("instagram").value;
            const twitter = document.getElementById("twitter").value;
            const imageFile = document.getElementById("imageUpload").files[0];

            if (!name || !bio) {
                alert("Name and Bio are required!");
                return;
            }

            let imageUrl = "https://via.placeholder.com/100"; // Default image
            if (imageFile) {
                const formData = new FormData();
                formData.append("file", imageFile);
                formData.append("upload_preset", UPLOAD_PRESET);

                const response = await fetch(CLOUDINARY_URL, {
                    method: "POST",
                    body: formData
                });

                const data = await response.json();
                imageUrl = data.secure_url;
            }

            try {
                const docRef = db.collection("profiles").doc(name);
                await docRef.set({
                    name, bio, instagram, twitter, imageUrl
                });
                alert(`Profile Created! Share this link: ?id=${name}`);
                location.reload();
            } catch (error) {
                console.error("Error adding profile:", error);
            }
        }

        async function loadProfile() {
            const params = new URLSearchParams(window.location.search);
            if (!params.has("id")) return;

            const docId = params.get("id");
            const docRef = db.collection("profiles").doc(docId);
            const docSnap = await docRef.get();

            if (!docSnap.exists) {
                document.body.innerHTML = "<h2>Profile Not Found</h2>";
                return;
            }

            const data = docSnap.data();
            document.getElementById("profileContainer").innerHTML = `
                <div class="profile-card">
                    <div class="top-section"></div>
                    <img class="profile-image" src="${data.imageUrl}" alt="Profile Picture">
                    <div class="profile-details">
                        <div class="profile-name">${data.name}</div>
                        <div class="profile-bio">${data.bio}</div>
                        <div class="social-icons">
                            ${data.instagram ? `<a href="${data.instagram}" target="_blank"><i class="fab fa-instagram"></i></a>` : ""}
                            ${data.twitter ? `<a href="${data.twitter}" target="_blank"><i class="fab fa-twitter"></i></a>` : ""}
                        </div>
                    </div>
                </div>
            `;
        }

        loadProfile();
    </script>
</body>
</html>